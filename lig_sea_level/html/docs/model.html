
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Statistical model &#8212; lig_sea_level v Manual</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting" href="plotting.html" />
    <link rel="prev" title="Inference" href="inference.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/lig_sea_level.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="user.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="api.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="benchmarks.html">
  Benchmarks
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/blakedyer/lig_sea_level" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/bcdyer8" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          


            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="inference.html">
   Inference
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Statistical model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting.html">
   Plotting
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          



          


          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          



          


          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="statistical-model">
<h1>Statistical model<a class="headerlink" href="#statistical-model" title="Permalink to this headline">¶</a></h1>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lig_sea_level.model.get_model" title="lig_sea_level.model.get_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_model</span></code></a></p></td>
<td><p>Create a PyMC sea level regression model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lig_sea_level.model.get_GIA_holocene" title="lig_sea_level.model.get_GIA_holocene"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_GIA_holocene</span></code></a></p></td>
<td><p>GIA model emulator from trained neural network compatible with pymc model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lig_sea_level.model.get_GIA_lig" title="lig_sea_level.model.get_GIA_lig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_GIA_lig</span></code></a></p></td>
<td><p>GIA model emulator from trained neural network compatible with pymc model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lig_sea_level.model.get_IR" title="lig_sea_level.model.get_IR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_IR</span></code></a></p></td>
<td><p>A helper function that builds probabalistic indicative range distributions for each sample.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lig_sea_level.model.get_updown_rate" title="lig_sea_level.model.get_updown_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_updown_rate</span></code></a></p></td>
<td><p>A helper function that builds probabalistic uplift or subsidence for each sample.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ages</span></code></p></td>
<td><p>A helper function that builds probabalistic age priors for each sample.</p></td>
</tr>
</tbody>
</table>
<span class="target" id="module-lig_sea_level.model"></span><p>A collection of functions to build last interglacial sea level inference models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="lig_sea_level.model.get_GIA_holocene">
<span class="sig-prename descclassname"><span class="pre">lig_sea_level.model.</span></span><span class="sig-name descname"><span class="pre">get_GIA_holocene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LITHOSPHERE_THICKNESS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UPPER_MANTLE_VISCOSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LOWER_MANTLE_VISCOSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitudes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lig_sea_level/model.html#get_GIA_holocene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lig_sea_level.model.get_GIA_holocene" title="Permalink to this definition">¶</a></dt>
<dd><p>GIA model emulator from trained neural network compatible with pymc model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>W: list</strong></dt><dd><p>List of trained weights from a keras neural network consisting of a normalization layer followed by three 512 dense layers</p>
</dd>
<dt><strong>LITHOSPHERE_THICKNESS: value or pymc random variable</strong></dt><dd><p>Number representing the lithospheric thickness of a 1D GIA model.</p>
</dd>
<dt><strong>UPPER_MANTLE_VISCOSITY: value or pymc random variable</strong></dt><dd><p>Number representing the upper mantle viscosity of a 1D GIA model.</p>
</dd>
<dt><strong>LOWER_MANTLE_VISCOSITY: value or pymc random variable</strong></dt><dd><p>Number representing the lower mantle viscosity of a 1D GIA model.</p>
</dd>
<dt><strong>ages: array of sample ages (actual values or draws from prior)</strong></dt><dd><p>The age of each sample.</p>
</dd>
<dt><strong>latitudes: array of sample latitudes</strong></dt><dd><p>The latitude of each sample</p>
</dd>
<dt><strong>longitudes: array of sample longitudes</strong></dt><dd><p>The longitude of each sample</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>GIA: aesara.tensor</dt><dd><p>Aesara tensor containing the GIA prediction for each sample</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lig_sea_level.model.get_GIA_lig">
<span class="sig-prename descclassname"><span class="pre">lig_sea_level.model.</span></span><span class="sig-name descname"><span class="pre">get_GIA_lig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LITHOSPHERE_THICKNESS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">UPPER_MANTLE_VISCOSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LOWER_MANTLE_VISCOSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SIS_SIZE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2_RATE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitudes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lig_sea_level/model.html#get_GIA_lig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lig_sea_level.model.get_GIA_lig" title="Permalink to this definition">¶</a></dt>
<dd><p>GIA model emulator from trained neural network compatible with pymc model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>W: list</strong></dt><dd><p>List of trained weights from a keras neural network consisting of a normalization layer followed by three 512 dense layers</p>
</dd>
<dt><strong>LITHOSPHERE_THICKNESS: value or pymc random variable</strong></dt><dd><p>Number representing the lithospheric thickness of a 1D GIA model.</p>
</dd>
<dt><strong>UPPER_MANTLE_VISCOSITY: value or pymc random variable</strong></dt><dd><p>Number representing the upper mantle viscosity of a 1D GIA model.</p>
</dd>
<dt><strong>LOWER_MANTLE_VISCOSITY: value or pymc random variable</strong></dt><dd><p>Number representing the lower mantle viscosity of a 1D GIA model.</p>
</dd>
<dt><strong>SIS_SIZE: value or pymc random variable</strong></dt><dd><p>The 1D GIA model paremeter for the size of the Scandinavian ice sheet at the penultimate glacial maximum in meters of sea level equivalance.</p>
</dd>
<dt><strong>T2_RATE: value or pymc random variable</strong></dt><dd><p>A relative rate from 0 to 1 representing a slow (0) or fast (1) transition from MIS 6 to MIS 5e.</p>
</dd>
<dt><strong>ages: array of sample ages (actual values or draws from prior)</strong></dt><dd><p>The age of each sample.</p>
</dd>
<dt><strong>latitudes: array of sample latitudes</strong></dt><dd><p>The latitude of each sample</p>
</dd>
<dt><strong>longitudes: array of sample longitudes</strong></dt><dd><p>The longitude of each sample</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>GIA: aesara.tensor</dt><dd><p>Aesara tensor containing the GIA prediction for each sample</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lig_sea_level.model.get_IR">
<span class="sig-prename descclassname"><span class="pre">lig_sea_level.model.</span></span><span class="sig-name descname"><span class="pre">get_IR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ig_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interglacial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lig_sea_level/model.html#get_IR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lig_sea_level.model.get_IR" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function that builds probabalistic indicative range distributions for each sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict</strong></dt><dd><p>A dictionary yada yada</p>
</dd>
<dt><strong>ig_index:</strong></dt><dd><p>Indices for the samples that match the correct interglacial</p>
</dd>
<dt><strong>region: string</strong></dt><dd><p>Name of the region</p>
</dd>
<dt><strong>interglacial: string</strong></dt><dd><p>Last interglacial (‘lig’) or Holocene (‘hol’)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: aesara.tensor</dt><dd><p>A tensor containing the indicate range of each sample.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lig_sea_level.model.get_model">
<span class="sig-prename descclassname"><span class="pre">lig_sea_level.model.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lig_sea_level/model.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lig_sea_level.model.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PyMC sea level regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict</strong></dt><dd><p>A dictionary yada yada</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: pymc.Model</dt><dd><p>PyMC Model object</p>
</dd>
<dt>gp: dict of {‘region’: pymc.gp.Latent}</dt><dd><p>The gaussian process prior for each region in this model. The gp object is used to generate posterior predictions
across the LIG.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lig_sea_level.model.get_updown_rate">
<span class="sig-prename descclassname"><span class="pre">lig_sea_level.model.</span></span><span class="sig-name descname"><span class="pre">get_updown_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ig_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interglacial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lig_sea_level/model.html#get_updown_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lig_sea_level.model.get_updown_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function that builds probabalistic uplift or subsidence for each sample. We force uplift or subsidence to covary for the region, although it can scale sample to sample. For example, take the case where sample A could have experienced between 1 and 10 meters of uplift, and sample B could have experienced between 1 and 5 meters of subsidence. When sample A is simulated near the upper end of its range sample B will also be near the upper end of its range. Each sample can be treated independently (with some numerical cost). Uplift is positive and subsidence is negative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data: dict</strong></dt><dd><p>A dictionary yada yada</p>
</dd>
<dt><strong>ig_index: array of integer indices</strong></dt><dd><p>Indices for the samples that match the correct interglacial</p>
</dd>
<dt><strong>region: string</strong></dt><dd><p>Name of the region</p>
</dd>
<dt><strong>interglacial: string</strong></dt><dd><p>Last interglacial (‘lig’) or Holocene (‘hol’)</p>
</dd>
<dt><strong>master_rate: pm.RandomValue or value</strong></dt><dd><p>A region specific centered random normal variable (or a draw from one).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: aesara.tensor</dt><dd><p>A tensor containing the uplift or subsidence rate (per ky) for each sample.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
          </main>
          



      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Blake Dyer.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>